<!DOCTYPE html>
<html>

<head>
  <title>estore</title>

  <!-- Disallow attacker POST request through connect-src   -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'unsafe-inline' http://localhost:4307; connect-src http://localhost:4307; style-src 'self' 'unsafe-inline'; object-src 'none';">


  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div class="payment-card">
    <div class="payment-header">
      <div class="secure-badge">
        <span>ðŸ”’</span> Secure SSL Encryption
      </div>
      <h2>Payment Details</h2>
      <p>Complete your purchase securely</p>
    </div>

    <div class="form-group">
      <label class="form-label">Card Information</label>
      <input type="text" id="input" class="form-input" placeholder="0000 0000 0000 0000" value="4111 1111 1111 1111">
    </div>

    <div class="row">
      <div class="col form-group">
        <label class="form-label">Expiry Date</label>
        <input type="text" class="form-input" placeholder="MM / YY" value="12/30">
      </div>
      <div class="col form-group">
        <label class="form-label">CVC</label>
        <input type="text" class="form-input" placeholder="123" value="737">
      </div>
    </div>

    <div class="form-group">
      <label class="form-label">Cardholder Name</label>
      <input type="text" class="form-input" placeholder="Full Name" value="Radu Dan">
    </div>

    <button onclick="exploit()" class="btn-pay">Pay $49.99</button>

    <div id="output" style="margin-top: 1rem; color: green; text-align: center;"></div>
  </div>

  <script>
    localStorage.setItem('authToken', 'secret-token-2342432354234');

    function exploit() {
      console.log('Exploiting XSS vulnerability.. triggers a POST request to attacker server');
      // This is the vulnerable line (real apps sometimes still do this!)
      document.getElementById('output').innerHTML = 'Payment successful! ðŸŽ‰';
    }
  </script>
  <script src="http://localhost:4307/trusted-external-script.js"></script>
</body>

</html>